# 性能监控工具配置
app:
  name: ebpf_monitor
  version: 1.0.0
  description: eBPF Monitor for Linux
  author: bwyu
  email: bwyu@czce.com.cn
  url: https://github.com/whosneo/ebpf_monitor
  environment: development
  debug: true

# 日志配置
logging:
  version: 1
  level: DEBUG                    # DEBUG, INFO, WARNING, ERROR
  formatters:
    detailed:
      format: "%(asctime)s [%(levelname)s] %(name)s:%(lineno)d %(message)s"
    simple:
      format: "%(asctime)s [%(levelname)s] %(message)s"
  handlers:
    console:
      class: logging.StreamHandler
      formatter: simple
      stream: ext://sys.stdout
    file:
      class: logging.handlers.TimedRotatingFileHandler
      formatter: detailed
      filename: monitor.log
      when: D
      interval: 1
      backupCount: 365

# 输出控制器配置
output:
  buffer_size: 5000                 # 缓冲区大小，用来处理高频事件
  batch_size: 1000                  # 批处理大小
  large_batch_threshold: 500        # 大批次阈值（触发立即刷盘）
  flush_interval: 2.0               # 刷新间隔
  output_thread_sleep: 0.1          # 输出线程休眠时间（秒）
  csv_delimiter: ","                # CSV分隔符
  include_header: true              # 是否包含头部

# 监控器配置
monitors:
  # 进程执行监控
  exec:
    enabled: true

  open:
    enabled: true
    interval: 2                # 统计周期（秒）
    min_count: 1               # 最小访问次数过滤
    show_errors_only: false    # 只显示有错误的操作

  # BIO监控（Block IO）
  bio:
    enabled: true
    interval: 2                    # 统计周期（秒）
    min_latency_us: 0              # 最小延迟过滤（微秒，0表示不过滤）

  # 系统调用监控
  syscall:
    enabled: true
    interval: 2              # 统计周期（秒）
    monitor_categories:
      file_io: true          # 文件IO系统调用
      network: true          # 网络系统调用
      memory: true           # 内存系统调用
      process: true          # 进程管理系统调用
      signal: false          # 信号系统调用
      time: false            # 时间系统调用
      ipc: true              # 进程间通信系统调用
    show_errors_only: false  # 只显示有错误的调用

  # 内核函数监控
  func:
    enabled: true
    interval: 2
    patterns: [ "vfs_read", "vfs_write" ]
    probe_limit: 10

  # 中断监控
  interrupt:
    enabled: true
    interval: 2

  # 内存监控
  page_fault:
    enabled: true
    interval: 2                # 统计周期（秒）

  # 上下文切换监控
  context_switch:
    enabled: true
    interval: 2              # 统计周期（秒）
    min_switches: 10         # 最小切换次数过滤
